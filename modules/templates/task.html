{% extends "base.html" %}
{% import "macros.html" as macros with context %}

<!--suppress ALL-->
{% block body %}
<title>{{ task.name }}</title>
<div id="taskContent" class="my-3">
  <input value="{{ task.name }}" id="name{{ task.id }}" autocomplete="off" class="form-control mb-2" onchange="taskEdit({{ task.id }})">
  <textarea autocomplete="off" class="form-control mb-2" id="note{{ task.id }}" onchange="taskEdit({{ task.id }})" placeholder="Note" rows="10">{{ task.note or '' }}</textarea>
  <select id="folder{{ task.id }}" class="form-control" autocomplete="off" onchange="taskEdit({{ task.id }})">
    {% for i in current_user.folders %}
    <option value="{{ i.id }}" {% if i.id==task.folders.id %}selected{% endif %}>{{ i.name }}</option>
    {% endfor %}
  </select>
</div>
{% if task.subtasks.count() > 0 %}
<div class="mt-3" id="allTasks">
  <div class="progress mb-3">
    <div class="progress-bar" role="progressbar" id="progress{{ task.id }}" style="width:{{ task.get_subtasks_progress() }}%"></div>
  </div>
  {% for i in task.subtasks | sort(attribute='done') %}
  <div class="list-group-item-action">
    <a class="link" onclick="taskToggle({{ i.id }})">{{ macros.check_icon(i.done, size=16) }}</a>
    <span>{{ i.name }}</span>
    <a href="{{ url_for('tasks.task_delete', id_=i.id) }}" class="link float-end">{{ macros.delete_icon(size=16) }}</a>
  </div>
  {% endfor %}
</div>
{% endif %}
{% endblock %}