{% macro paragraph(text, class='', size=1) %}
<!--suppress ALL-->
<p class="{{ class }}" style="font-size:{{ size }}em">{{ text }}</p>
{% endmacro %}

{% macro link(href='#', color='black', newtab=false, modal_id='', class='') %}
<a href="{{ href }}"
   style="text-decoration:none; color:{{ color }};"
   class="{{ class }}"
   {% if newtab %}
   target="_blank"
   {% endif %}

   {% if modal_id %}
   data-toggle="modal"
   data-target="#{{ modal_id }}"
   {% endif %}
>
  {{ caller() }}
</a>
{% endmacro %}

{% macro button(text, bg_color='black', txt_color='white') %}
<button type="submit"
        class="btn w-100"
        style="background-color:{{ bg_color }}; color:{{ txt_color }}"
>
  {{ text }}
</button>
{% endmacro %}

<!--Generic Badge-->
{% macro badge(text, class='', txt_color='white', bg_color='black', pill=false, newtab=false, modal_id='', href='') %}
<a class="badge {% if pill %}badge-pill{% endif %} {{ class }}"
   {% if href %}href="{{ href }}" {% endif %}
   style="text-decoration:none; color:{{ txt_color }}; background-color:{{ bg_color }};"
   {% if newtab %}
   target="_blank"
   {% endif %}

   {% if modal_id %}
   data-toggle="modal"
   data-target="{{ modal_id }}"
   {% endif %}
>
  {{ text }}
</a>
{% endmacro %}

{% macro modal(id, title='', lg=false) %}
<div class="modal" id="{{ id }}">
  <div class="modal-dialog {% if lg %}modal-lg{% endif %}">
    <div class="modal-content p-3">
      {% if title %}{{ paragraph(title, class='text-center m-3', size=3) }}{% endif %}
      {{ caller() }}
    </div>
  </div>
</div>
{% endmacro %}

{% macro dropdown(text, class='') %}
<div class="dropdown {{ class }}">
  <a href="#" data-toggle="dropdown">{{ text }}</a>
  <div class="dropdown-menu">
    {{ caller() }}
  </div>
</div>
{% endmacro %}

{% macro input(name, placeholder, class='', value='') %}
<input type="text" autocomplete="off" class="form-control {{ class }}" name="{{ name }}" placeholder="{{ placeholder }}" value="{{ value }}">
{% endmacro %}

{% macro brand_icon(size=25, color='white') %}
<svg xmlns="http://www.w3.org/2000/svg" width="{{ size }}" height="{{ size }}" fill="{{ color }}" class="bi bi-check-all" viewBox="0 0 16 16">
  <path d="M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992a.252.252 0 0 1 .02-.022zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486-.943 1.179z"/>
</svg>
{% endmacro %}

{% macro add_icon(size=25, color='green') %}
<svg xmlns="http://www.w3.org/2000/svg" width="{{ size }}" height="{{ size }}" fill="{{ color }}" class="bi bi-plus-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
  <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
</svg>
{% endmacro %}

{% macro delete_icon(size=25, color='red') %}
<svg xmlns="http://www.w3.org/2000/svg" width="{{ size }}" height="{{ size }}" fill="{{ color }}" class="bi bi-x-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
  <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
</svg>
{% endmacro %}

{% macro edit_icon(size=25, color='black') %}
<svg xmlns="http://www.w3.org/2000/svg" width="{{ size }}" height="{{ size }}" fill="{{ color }}" class="bi bi-pencil-square" viewBox="0 0 16 16">
  <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
  <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
</svg>
{% endmacro %}

{% macro reminder_icon(size=25, color='black') %}
<svg xmlns="http://www.w3.org/2000/svg" width="{{ size }}" height="{{ size }}" fill="{{ color }}" class="bi bi-alarm" viewBox="0 0 16 16">
  <path d="M8.5 5.5a.5.5 0 0 0-1 0v3.362l-1.429 2.38a.5.5 0 1 0 .858.515l1.5-2.5A.5.5 0 0 0 8.5 9V5.5z"/>
  <path d="M6.5 0a.5.5 0 0 0 0 1H7v1.07a7.001 7.001 0 0 0-3.273 12.474l-.602.602a.5.5 0 0 0 .707.708l.746-.746A6.97 6.97 0 0 0 8 16a6.97 6.97 0 0 0 3.422-.892l.746.746a.5.5 0 0 0 .707-.708l-.601-.602A7.001 7.001 0 0 0 9 2.07V1h.5a.5.5 0 0 0 0-1h-3zm1.038 3.018a6.093 6.093 0 0 1 .924 0 6 6 0 1 1-.924 0zM0 3.5c0 .753.333 1.429.86 1.887A8.035 8.035 0 0 1 4.387 1.86 2.5 2.5 0 0 0 0 3.5zM13.5 1c-.753 0-1.429.333-1.887.86a8.035 8.035 0 0 1 3.527 3.527A2.5 2.5 0 0 0 13.5 1z"/>
</svg>
{% endmacro %}

{% macro folder_card(folder) %}
<div class="card col-xl-4 border-0 rounded">
  <div class="card-body m-2 p-3 shadow-sm" style="background-color:{{ folder.color }}; border-radius:10px;">
    <a class="" style="mix-blend-mode:difference; color:orange" href="#">
      {{ folder.name }}{{ badge(folder.tasks|count|string, class='mx-2', bg_color='white', txt_color='black') }}
    </a>
    <span class="float-right">
      {% call link(class='mx-1', modal_id='task_create_%s'%folder.id) %}{{ add_icon(size=20) }}{% endcall %}
      {% call link(class='mx-1', modal_id='folder_update_%s'%folder.id) %}{{ edit_icon(size=20) }}{% endcall %}
      {% call link(class='mx-1', modal_id='folder_delete_%s'%folder.id) %}{{ delete_icon(size=20) }}{% endcall %}
    </span>
  </div>
  {% call modal('task_create_%s'%folder.id, title='New Task') %}
  {{ task_create_form(folder) }}
  {% endcall %}

  {% call modal('folder_update_%s'%folder.id, title='Edit Folder') %}
  {{ folder_update_form(folder) }}
  {% endcall %}

  {% call modal('folder_delete_%s'%folder.id, title='Delete Folder?') %}
  {% call link(class='btn btn-dark text-light', href=url_for('folder_delete', id_=folder.id)) %}Delete{% endcall %}
  {% endcall %}
</div>
{% endmacro %}

{% macro task_card(task) %}
<div class="card col-xl-12 border-0 rounded">
  <div class="card-body border m-2 p-3 shadow-sm" style="border-radius:10px;">
    {{ badge(task.get_priority()[0], bg_color=task.get_priority()[1], txt_color='gray', class='mx-2') }}
    {{ paragraph(task.name, class='font-italic d-inline mr-2') }}
    {% if task.reminder %}{{ reminder_icon(size=17) }}{% endif %}
    <div class="float-right">
      <a class="badge" style="background-color:{{ task.folders.color }}; color:white">{{ task.folders.name }}</a>
      {% call link(class='mx-1', modal_id='task_update_%s'%task.id) %}{{ edit_icon(size=20) }}{% endcall %}
      {% call link(class='mx-1', modal_id='task_delete_%s'%task.id) %}{{ delete_icon(size=20) }}{% endcall %}
    </div>
  </div>
  {% call modal('task_update_%s'%task.id, title='Edit Task') %}
  {{ task_update_form(task) }}
  {% endcall %}

  {% call modal('task_delete_%s'%task.id, title='Delete Task?') %}
  {% call link(class='btn btn-dark text-light', href=url_for('task_delete', id_=task.id)) %}Delete{% endcall %}
  {% endcall %}
</div>
{% endmacro %}

{% macro habit_card(habit) %}
<div class="card col-xl-12 border-0 rounded">
  <div class="card-body border m-2 p-3 shadow-sm" style="border-radius:10px;">
    {{ paragraph(habit.name, class='font-italic d-inline mr-2') }}
    <div class="float-right">
      {% call link(class='mx-1', modal_id='habit_update_%s'%habit.id) %}{{ edit_icon(size=20) }}{% endcall %}
      {% call link(class='mx-1', modal_id='habit_delete_%s'%habit.id) %}{{ delete_icon(size=20) }}{% endcall %}
    </div>
  </div>
  {% call modal('habit_update_%s'%habit.id, title='Edit Habit') %}
  {{ habit_update_form(habit) }}
  {% endcall %}

  {% call modal('habit_delete_%s'%habit.id, title='Delete Habit?') %}
  {% call link(class='btn btn-dark text-light', href=url_for('habit_delete', id_=habit.id)) %}Delete{% endcall %}
  {% endcall %}
</div>
{% endmacro %}

{% macro task_create_form(folder='', class='') %}
<form class="form-group" method="POST" action="{{ url_for('task_create') }}">
  {{ input('name', 'Name', class='mb-2') }}
  <select class="form-control mb-2" name="priority">
    <option value="3">Low</option>
    <option value="2">Medium</option>
    <option value="1">High</option>
  </select>
  {{ input('note', 'Note', class='mb-2') }}
  <select name="folder" class="form-control mb-2">
    <option>Select</option>
    {% for i in all_folders %}
    <option value="{{ i.id }}" {% if folder.id==i.id %}selected{% endif %}>{{ i.name }}</option>
    {% endfor %}
  </select>
  {{ button('Submit') }}
</form>
{% endmacro %}

{% macro task_update_form(task, class='') %}
<form class="form-group" method="POST" action="{{ url_for('task_update', id_=task.id) }}">
  {{ input('name', 'Name', class='mb-2', value=task.name) }}
  <select class="form-control mb-2" name="priority">
    <option value="3" {% if task.priority==3 %}selected{% endif %}>Low</option>
    <option value="2" {% if task.priority==2 %}selected{% endif %}>Medium</option>
    <option value="1" {% if task.priority==1 %}selected{% endif %}>High</option>
  </select>
  {{ input('note', 'Note', class='mb-2', value=task.note) }}
  <select name="folder" class="form-control mb-2">
    <option>Select</option>
    {% for i in all_folders %}
    <option value="{{ i.id }}" {% if task.folder== i.id %}selected{% endif %}>{{ i.name }}</option>
    {% endfor %}
  </select>
  {{ button('Submit') }}
</form>
{% endmacro %}

{% macro folder_create_form(class='') %}
<form class="form-group" method="POST" action="{{ url_for('folder_create') }}">
  {{ input('name', 'Name', class='mb-2') }}
  {{ button('Submit') }}
</form>
{% endmacro %}

{% macro folder_update_form(folder, class='') %}
<form class="form-group" method="POST" action="{{ url_for('folder_update', id_=folder.id) }}">
  {{ input('name', 'Name', class='mb-2', value=folder.name) }}
  <input type="color" autocomplete="off" class="form-control mb-2" name="color" value="{{ folder.color }}">
  {{ button('Edit') }}
</form>
{% endmacro %}

{% macro habit_create_form(class='') %}
<form class="form-group" method="POST" action="{{ url_for('habit_create') }}">
  {{ input('name', 'Name', class='mb-2') }}
  <select name="frequency" class="form-control mb-2">
    <option value="Daily">Daily</option>
    <option value="Weekly">Weekly</option>
    <option value="Monthly">Monthly</option>
  </select>
  {{ button('Submit') }}
</form>
{% endmacro %}

{% macro habit_update_form(habit, class='') %}
<form class="form-group" method="POST" action="{{ url_for('habit_update', id_=habit.id) }}">
  {{ input('name', 'Name', class='mb-2', value=habit.name) }}
  <select name="frequency" class="form-control mb-2">
    <option value="Daily">Daily</option>
    <option value="Weekly">Weekly</option>
    <option value="Monthly">Monthly</option>
  </select>
  <input type="color" autocomplete="off" class="form-control mb-2" name="color" value="{{ habit.color }}">
  {{ button('Submit') }}
</form>
{% endmacro %}

{% macro folders_sort(class='') %}
<div class="list-inline" style="font-size:0.9em">
  {{ paragraph('Sort by:', class='list-inline-item') }}
  {% if order_by != 'name' %}{{ badge('Name', class='list-inline-item', pill=true, bg_color='black', href=url_for('folders', order_by='name')) }}{% endif %}
  {% if order_by != 'date_created desc' %}{{ badge('Date Created', class='list-inline-item', pill=true, bg_color='black', href=url_for('folders', order_by='date_created desc')) }}{% endif %}
</div>
{% endmacro %}

{% macro tasks_sort(class='') %}
<div class="list-inline" style="font-size:0.9em">
  {{ paragraph('Sort by:', class='list-inline-item') }}
  {% if order_by != 'priority' %}{{ badge('Priority', class='list-inline-item', pill=true, bg_color='green', href=url_for('tasks', order_by='priority')) }}{% endif %}
  {% if order_by != 'tasks.date_created desc' %}{{ badge('Date Created', class='list-inline-item', pill=true, bg_color='green', href=url_for('tasks', order_by='tasks.date_created desc')) }}{% endif %}
  {% if order_by != 'folders.name' %}{{ badge('Folder', class='list-inline-item', pill=true, bg_color='green', href=url_for('tasks', order_by='folders.name')) }}{% endif %}
</div>
{% endmacro %}

{% macro lists_sort(class='') %}
<div class="list-inline" style="font-size:0.9em">
  {{ paragraph('Sort by:', class='list-inline-item') }}
  {% if order_by != 'date_created desc' %}{{ badge('Date Created', class='list-inline-item', pill=true, bg_color='purple', href=url_for('lists', order_by='date_created desc')) }}{% endif %}
  {% if order_by != 'date_updated desc' %}{{ badge('Date Updated', class='list-inline-item', pill=true, bg_color='purple', href=url_for('lists', order_by='date_updated desc')) }}{% endif %}
</div>
{% endmacro %}